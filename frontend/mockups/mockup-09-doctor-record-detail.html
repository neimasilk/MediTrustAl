<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediTrustAl - Doctor: Record Detail Mockup</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            background-color: #f4f7f9;
            color: #333;
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 250px;
            background: #2c3e50;
            color: white;
            padding-top: 20px;
        }
        .sidebar-header {
            padding: 20px;
            text-align: center;
            font-size: 1.5em;
            border-bottom: 1px solid #34495e;
        }
        .sidebar-nav ul {
            list-style-type: none;
            padding: 0;
        }
        .sidebar-nav li a {
            display: block;
            padding: 15px 20px;
            color: #ecf0f1;
            text-decoration: none;
            transition: background 0.2s;
            border-left: 3px solid transparent;
        }
        .sidebar-nav li a:hover, .sidebar-nav li a.active {
            background: #34495e;
            border-left-color: #1abc9c; /* Doctor theme color */
        }
        .sidebar-nav li a .icon {
            margin-right: 10px;
        }
        .main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        .top-nav {
            background: #ffffff;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e0e0e0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .back-btn {
            background-color: #7f8c8d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            text-decoration: none;
        }
        .back-btn:hover {
            background-color: #6c7a7d;
        }
        .user-profile {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .user-profile img {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            margin-right: 10px;
        }
        .user-profile span {
            font-weight: 500;
        }
        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 20px;
            font-size: 0.9em;
        }
        .logout-btn:hover {
            background: #c0392b;
        }
        .content-area {
            padding: 30px;
            flex-grow: 1;
            overflow-y: auto;
        }
        .content-header h1 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 5px;
        }
        .content-header .sub-header-info {
            color: #7f8c8d;
            font-size: 0.9em;
            margin-bottom: 20px;
            word-break: break-all;
        }
        .record-detail-card {
            background: white;
            padding: 25px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            margin-bottom: 25px;
        }
        .record-detail-card h2 {
            margin-top: 0;
            color: #16a085; /* Doctor theme accent */
            font-size: 1.3em;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .detail-item p {
            margin: 5px 0;
            font-size: 0.95em;
            line-height: 1.6;
        }
        .detail-item strong {
            color: #34495e;
            margin-right: 8px;
        }
        .raw-data-section, .metadata-section, .ai-nlp-section {
            margin-top: 20px;
        }
        .raw-data-content, .metadata-content {
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
            white-space: pre-wrap; /* Preserve formatting */
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }
        .ai-nlp-section .placeholder-text {
            color: #7f8c8d;
            font-style: italic;
        }

        /* Simple icons */
        .icon-dashboard::before { content: "üè†"; }
        .icon-search-patient::before { content: "üîç"; }
        .icon-accessed-records::before { content: "üìÇ"; }
        .icon-profile::before { content: "üë§"; }
        .icon-back::before { content: "‚¨ÖÔ∏è"; }
        .icon-info::before { content: "‚ÑπÔ∏è "; }
        .icon-notes::before { content: "üìù "; }
        .icon-brain::before { content: "üß† "; }


        /* Responsive adjustments */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            .content-area {
                padding: 15px;
            }
            .detail-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">MediTrustAl</div>
        <nav class="sidebar-nav">
            <ul>
                 <li><a href="mockup-07-doctor-dashboard.html"><span class="icon icon-dashboard"></span>Dashboard</a></li>
                <li><a href="#" class="active"><span class="icon icon-search-patient"></span>Search Patient</a></li>
                <li><a href="#"><span class="icon icon-accessed-records"></span>Accessed Records</a></li>
                <li><a href="#"><span class="icon icon-profile"></span>Profile</a></li>
            </ul>
        </nav>
    </aside>

    <div class="main-content">
        <header class="top-nav">
            <a href="#" onclick="goBackToPatientDetail()" class="back-btn"><span class="icon icon-back"></span> Back to Patient List</a>
            <div class="user-profile">
                 <img src="https://placehold.co/40x40/1abc9c/FFFFFF?text=DR&font=Inter" alt="Doctor Avatar"
                      onerror="this.onerror=null; this.src='https://placehold.co/40x40/cccccc/ffffff?text=Error&font=Inter';">
                <span>Dr. Smith</span>
            </div>
            <button class="logout-btn">Logout</button>
        </header>

        <main class="content-area">
            <div class="content-header">
                <h1>Medical Record Detail</h1>
                <p class="sub-header-info">
                    Patient DID: <span id="patientDid">did:meditrustal:patient123...xyz</span> | Record ID: <span id="recordId">rec_001</span>
                </p>
            </div>

            <div class="record-detail-card">
                <h2><span class="icon icon-info"></span>Record Information</h2>
                <div class="detail-grid">
                    <div class="detail-item"><p><strong>Record Type:</strong> <span id="recordType">DIAGNOSIS</span></p></div>
                    <div class="detail-item"><p><strong>Date Created:</strong> <span id="dateCreated">2025-05-20</span></p></div>
                    <div class="detail-item"><p><strong>Data Hash:</strong> <span id="dataHash" style="word-break: break-all;">a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2</span></p></div>
                    <div class="detail-item"><p><strong>Blockchain Tx ID:</strong> <span id="blockchainTxId" style="word-break: break-all;">0xtxGrantHash123... (if available)</span></p></div>
                </div>

                <div class="metadata-section">
                    <h3><span class="icon icon-info"></span>Metadata</h3>
                    <pre id="metadataContent" class="metadata-content">{
    "doctor_id": "doc_123",
    "hospital": "General Hospital",
    "diagnosis_code": "J45.909",
    "status": "Final"
}</pre>
                </div>

                <div class="raw-data-section">
                    <h3><span class="icon icon-notes"></span>Raw Data (Decrypted)</h3>
                    <pre id="rawDataAccessibleData" class="raw-data-content">Patient presented with symptoms of acute exacerbation of asthma.
Wheezing audible on auscultation. Oxygen saturation at 92% on room air.
Administered nebulized albuterol with good response.
Plan: Continue current inhaler regimen, follow up in 3 days.
Advised on trigger avoidance.
                    </pre>
                     <!-- <div id="rawDataNoAccess" class="raw-data-content" style="color: #e74c3c; display:none;">
                        Access to raw data is restricted or decryption failed.
                    </div> -->
                </div>

                <div class="ai-nlp-section">
                    <h2><span class="icon icon-brain"></span>AI/NLP Analysis (Future)</h2>
                    <p class="placeholder-text">
                        Insights from NLP (e.g., extracted entities, sentiment) and AI predictions (e.g., risk scores, suggested actions) will be displayed here.
                    </p>
                    <!-- Example of how it might look:
                    <h4>Extracted Entities:</h4>
                    <ul>
                        <li>Symptom: Wheezing</li>
                        <li>Medication: Albuterol</li>
                        <li>Condition: Asthma</li>
                    </ul>
                    <h4>Risk Assessment:</h4>
                    <p>Moderate risk of re-exacerbation within 7 days.</p>
                    -->
                </div>
            </div>
        </main>
    </div>

    <script>
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        function loadRecordDetails() {
            const recordId = getQueryParam('recordId');
            const patientDid = getQueryParam('patientDid'); // Patient DID from previous page

            if (recordId) {
                document.getElementById('recordId').textContent = recordId;
                // In a real app, fetch record details using recordId
            } else {
                document.getElementById('recordId').textContent = "N/A";
            }
            if (patientDid) {
                 document.getElementById('patientDid').textContent = patientDid;
            } else {
                 document.getElementById('patientDid').textContent = "N/A";
            }


            // Mock data based on recordId (example)
            if (recordId === 'rec_001') {
                document.getElementById('recordType').textContent = 'DIAGNOSIS';
                document.getElementById('dateCreated').textContent = '2025-05-20';
                document.getElementById('dataHash').textContent = 'a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2';
                document.getElementById('blockchainTxId').textContent = '0xtxDiagnosisHash001...';
                document.getElementById('metadataContent').textContent = JSON.stringify({
                    "doctor_id": "doc_dr_smith",
                    "department": "Pulmonology",
                    "diagnosis_code": "J45.909 (Unspecified asthma)",
                    "assessment": "Acute exacerbation of asthma, moderate."
                }, null, 2);
                document.getElementById('rawDataAccessibleData').textContent = `Patient: John Doe (did:meditrustal:patient123...xyz)
Date: 2025-05-20
Attending: Dr. Smith

Subjective:
Patient reports increased shortness of breath and wheezing over the past 24 hours.
Usual albuterol inhaler provides only temporary relief. No fever or chills.

Objective:
BP: 130/85 mmHg, HR: 98 bpm, RR: 24/min, Temp: 37.1¬∞C, O2 Sat: 92% on RA.
Auscultation: Bilateral expiratory wheezes present. Moderate respiratory distress.

Assessment:
Acute exacerbation of asthma, moderate.

Plan:
1. Administer nebulized albuterol 2.5mg and ipratropium 0.5mg STAT.
2. Monitor response and O2 saturation.
3. Consider short course of oral corticosteroids if no significant improvement.
4. Reinforce asthma action plan and trigger avoidance.
5. Follow-up in clinic in 3 days or sooner if symptoms worsen.`;
            } else if (recordId === 'rec_005') {
                document.getElementById('recordType').textContent = 'LAB_RESULT';
                document.getElementById('dateCreated').textContent = '2025-04-10';
                document.getElementById('dataHash').textContent = 'b3c4d5e6f7g8b3c4d5e6f7g8b3c4d5e6f7g8b3c4d5e6f7g8b3c4d5e6f7g8b3c4';
                document.getElementById('blockchainTxId').textContent = '0xtxLabResultHash005...';
                document.getElementById('metadataContent').textContent = JSON.stringify({
                    "lab_id": "LAB-2025-04-10-001",
                    "test_panel": "Complete Blood Count (CBC)",
                    "ordered_by": "Dr. Jones"
                }, null, 2);
                document.getElementById('rawDataAccessibleData').textContent = `Lab Report - Patient: John Doe
Collection Date: 2025-04-10
Test: Complete Blood Count (CBC)

WBC: 7.5 x10^9/L (Ref: 4.0-11.0)
RBC: 4.8 x10^12/L (Ref: 4.5-5.5)
Hemoglobin: 14.2 g/dL (Ref: 13.5-17.5)
Hematocrit: 42% (Ref: 40-50%)
Platelets: 250 x10^9/L (Ref: 150-400)

Interpretation: Within normal limits.
Performed by: City Central Lab`;
            } else {
                // Default or error state
                document.getElementById('recordType').textContent = 'N/A';
                document.getElementById('dateCreated').textContent = 'N/A';
                document.getElementById('dataHash').textContent = 'N/A';
                document.getElementById('blockchainTxId').textContent = 'N/A';
                document.getElementById('metadataContent').textContent = '{}';
                document.getElementById('rawDataAccessibleData').textContent = 'Record data not found or access denied.';
            }
        }

        function goBackToPatientDetail() {
            const patientDid = getQueryParam('patientDid') || "did:meditrustal:unknown"; // Fallback if not in URL
            // In a real app, use React Router or similar for navigation
            alert(`Navigating back to patient detail for DID: ${patientDid} (Mock)`);
            window.location.href = `mockup-08-doctor-patient-detail.html?did=${patientDid}`;
        }

        document.addEventListener('DOMContentLoaded', loadRecordDetails);
    </script>
</body>
</html>
